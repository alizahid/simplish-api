# Migration `20201005041812-initial`

This migration has been generated by Ali Zahid at 10/5/2020, 9:18:12 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."List" (
"id" SERIAL,
"name" text   NOT NULL ,
"itemOrder" integer []  ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Item" (
"id" SERIAL,
"listId" integer   NOT NULL ,
"userId" integer   NOT NULL ,
"body" text   NOT NULL ,
"description" text   ,
"date" timestamp(3)   ,
"complete" boolean   NOT NULL DEFAULT false,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Comment" (
"id" SERIAL,
"itemId" integer   NOT NULL ,
"userId" integer   NOT NULL ,
"body" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Board" (
"id" SERIAL,
"name" text   NOT NULL ,
"listOrder" integer []  ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_Assignee" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL
)

CREATE TABLE "public"."_BoardToUser" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL
)

CREATE TABLE "public"."_ListToUser" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL
)

CREATE TABLE "public"."_BoardToList" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL
)

CREATE UNIQUE INDEX "_Assignee_AB_unique" ON "public"."_Assignee"("A", "B")

CREATE INDEX "_Assignee_B_index" ON "public"."_Assignee"("B")

CREATE UNIQUE INDEX "_BoardToUser_AB_unique" ON "public"."_BoardToUser"("A", "B")

CREATE INDEX "_BoardToUser_B_index" ON "public"."_BoardToUser"("B")

CREATE UNIQUE INDEX "_ListToUser_AB_unique" ON "public"."_ListToUser"("A", "B")

CREATE INDEX "_ListToUser_B_index" ON "public"."_ListToUser"("B")

CREATE UNIQUE INDEX "_BoardToList_AB_unique" ON "public"."_BoardToList"("A", "B")

CREATE INDEX "_BoardToList_B_index" ON "public"."_BoardToList"("B")

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("listId")REFERENCES "public"."List"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("itemId")REFERENCES "public"."Item"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_Assignee" ADD FOREIGN KEY ("A")REFERENCES "public"."Item"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_Assignee" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ListToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."List"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ListToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToList" ADD FOREIGN KEY ("A")REFERENCES "public"."Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_BoardToList" ADD FOREIGN KEY ("B")REFERENCES "public"."List"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201005041812-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,90 @@
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id Int @id @default(autoincrement())
+
+  firebaseId String  @unique
+  email      String  @unique
+  name       String
+  pushToken  String?
+  listOrder  Int[]
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  assigned Item[]    @relation("Assignee")
+  boards   Board[]
+  comments Comment[]
+  items    Item[]
+  lists    List[]
+}
+
+model List {
+  id Int @id @default(autoincrement())
+
+  name      String
+  itemOrder Int[]
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  board Board[]
+  items Item[]
+  users User[]
+}
+
+model Item {
+  id Int @id @default(autoincrement())
+
+  list   List @relation(fields: [listId], references: [id])
+  listId Int
+
+  user   User @relation(fields: [userId], references: [id])
+  userId Int
+
+  body        String
+  description String?
+  date        DateTime?
+  complete    Boolean   @default(false)
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  assignees User[]    @relation("Assignee")
+  comments  Comment[]
+}
+
+model Comment {
+  id Int @id @default(autoincrement())
+
+  item   Item @relation(fields: [itemId], references: [id])
+  itemId Int
+
+  user   User @relation(fields: [userId], references: [id])
+  userId Int
+
+  body String
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Board {
+  id Int @id @default(autoincrement())
+
+  name      String
+  listOrder Int[]
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  lists List[]
+  users User[]
+}
```
